<html>

	<head>
		<link href='https://fonts.googleapis.com/css?family=Josefin+Sans' rel='stylesheet' type='text/css'>
		<link href='https://fonts.googleapis.com/css?family=Source+Code+Pro' rel='stylesheet' type='text/css'>
		<style>
		/* Rotate */
		.hvr-rotate {
		  display: inline-block;
		  vertical-align: middle;
		  -webkit-transition-duration: 0.5s;
		  transition-duration: 0.5s;
		  -webkit-transition-property: transform;
		  transition-property: transform;
		}
		.hvr-rotate:hover, .hvr-rotate:focus, .hvr-rotate:active {
		  -webkit-transform: rotate(-360deg);
		  transform: rotate(-360deg);
		}
		/* Rotate Inverse*/
		.hvr-rotate-inverse {
		  display: inline-block;
		  vertical-align: middle;
		  -webkit-transition-duration: 0.5s;
		  transition-duration: 0.5s;
		  -webkit-transition-property: transform;
		  transition-property: transform;
		}
		.hvr-rotate-inverse:hover, .hvr-rotate-inverse:focus, .hvr-rotate-inverse:active {
		  -webkit-transform: rotate(360deg);
		  transform: rotate(360deg);
		}
		.rotado{
			-webkit-transform: rotate(180deg);
			transform: rotate(180deg);
		}
		.rotado:hover{
			-webkit-transform: rotate(540deg);
			transform: rotate(540deg);
		}
		</style>
		<style type="text/css">
			html, body {
				margin:0;
				padding:0;
			}
			#wrapper-site{
				width:100%;
				height:100%;
			}
			.bloco{ 
				float:left;
				width:52px;
				height:52px;
				margin:2px;			
				background-color:#DDDDDD;
				display:table-cell;
				border-radius:6px;
				cursor:pointer;	
				z-index:1;
			}
			#container{
				position: absolute;
				width:1360px;
				height:660px;
				background-image:url("grid-bg.png");				
				display: inline-block;
				margin:2px;
				margin-top:40px;
				padding-left:2px;
				padding-top:2px;
			}
			#wrapper-menu{
				position:absolute;
				width:100%;
				height:100%;
				display:none;
				z-index:2;
			}
			#menu{
				width:15%;
				height:100%;
				background-color:black;
				float:left;
			}
			#outside{
				width:85%;
				height:100%;
				float:left;
			}
			#wrapper-menu-direita{
				position:absolute;
				width:100%;
				height:100%;
				display:none;
				z-index:2;
			}
			#menu-direita{
				width:15%;
				height:100%;
				background-color:black;
				float:left;
			}
			#outside-direita{
				width:85%;
				height:100%;
				float:left;
			}
			
			.botao, .bota-chevron{
				color:#DDDDDD;
				font-family: 'Source Code Pro', ;
				font-size:150%;
				font-weight: 700;
				text-align:center;
				text-decoration:none;
				width:30px;
				margin-top:2px;
				margin-left:5px;
				background-color: #000000;
				border-radius: 50%;
				cursor:pointer;
				padding-top:-3px;
				border:solid rgba(255, 255,255, 0.1) 2px;
				display:inline-block;
				vertical-align:middle;
				float:left;
			}
			.botao:hover{
				background-color:#222222;
			}
			.formata{
				display:table-cell;
			}
			#div-cores{
				width:4%;
				height:70%;
				margin-top:4px;
				margin-left:5px;
				border-radius:10px;
				border:solid rgba(255, 255,255, 0.1) 2px;
				cursor:pointer;
				float:left;
			}
			.invisivel{
				width:1px;
				height:1px;
				opacity:0;
			}
			h1,h3, #creditos{
				text-align:center;
				color:#6AF50E;
				font-family: 'Josefin Sans', sans-serif;
			}
			#creditos{
				position:absolute;
				height:5%;
				bottom:0%;
				margin-left:4%;
			}
			#menu-direita h1, h3{
				margin-left:20px;
			}
			.separador{
				float:left;
				height:40px;
				margin-left:10px;
				margin-right:5px;
				border-right: 2px solid rgba(255, 255,255, 0.5);
			}
			#menu-total{
				width:100%;
				height:40px;
				background-color:black;
				position:fixed;
				left:0;
				top:0;
				z-index:1;
			}
			.titulo{
				float:left;
				text-align:center;
				color:#6AF50E;
				font-family: 'Josefin Sans', sans-serif;
				height:40px;
				font-size:30px;
				margin-right:20px;
				margin-left:10px;
				font-weight:700;
			}
			.ativo{
				 box-shadow: inset 0 0 2px #000000, inset 0 0 2px #000000, inset 0 0 2px #000000;
			}
			.especial{
				padding-top:2px;
				font-size:19.5;
			}
			.clearboth{
				clear:both;
			}
		</style>
	
	<head>

	
	<body>
		<div id="wrapper-site">
			<div id="menu-total">
				<span class="titulo">Gridder</span>
				<div id="novo-bloco" class="botao botao-primeiro hvr-rotate-inverse"><a class="">+</a></div>
				<div class="separador"></div>
				<div id="div-cores"></div>
				<input type="color" id="color-picker" class="invisivel">
				<div class="separador"></div>
				<div id="aumentar-esquerda" class="botao hvr-rotate-inverse">
					<a id="direita-menos" class=""><</a>
				</div>
				<div id="aumentar-direita" class="botao hvr-rotate">
					<a id="direita-mais" class="">></a>
				</div>
				<div id="aumentar-baixo" class="botao hvr-rotate">
					<a id="baixo-mais" class="">v</a>
				</div>
				<div id="aumentar-cima" class="botao hvr-rotate-inverse">
					<a id="baixo-menos" class=""><span class="especial">‚ãÄ</span></a>
				</div>
				<div class="separador"></div>
				<div id="margem-esquerda" class="botao hvr-rotate-inverse">
					<a id="margem-menos-direita" class="">‚Üê</a>
				</div>
				<div id="margem-direita" class="botao hvr-rotate">
					<a id="margem-mais-direita" class="">‚Üí</a>
				</div>
				<div id="margem-baixo" class="botao hvr-rotate-inverse">
					<a id="margem-mais-baixo" class="">‚Üì</a>
				</div>
				<div id="margem-cima" class="botao hvr-rotate">
					<a id="margem-menos-baixo" class="">‚Üë</a>
				</div>
				<div class="separador"></div>
				<div id="escape" class="botao hvr-rotate-inverse" style="height:30px; overflow:hidden;">
					<a id="escape-new-line" ><span class="especial" style="font-weight:1000;font-size:27;margin-left:-1px; margin-top:-10px;">&#10550;</span></a>
				</div>
				<div id="descape" class="botao hvr-rotate-inverse rotado" style="height:30px; overflow:hidden;">
					<a id="descape-back-line" ><span class="especial" style="font-weight:1000;font-size:27;top:2px">&#10551;</span></a>
				</div>
				<div class="separador"></div>
				<div id="excluir" class="botao hvr-rotate-inverse"style="height:30px">
					<a id="delete" ><span class="especial" >x</span></a>
				</div>
				<div class="separador"></div>
				<div id="salvar" class="botao hvr-rotate-inverse"style="height:30px">
					<a id="save">üíæ</a>
				</div>
			</div>
			<div id='container' class="sortable">
			</div>
		</div>
	</body>	
	
	<script src="https://code.jquery.com/jquery-2.1.4.js"></script>
	<link rel="stylesheet" href="https://code.jquery.com/ui/1.11.4/themes/vader/jquery-ui.css">
	<script src="https://code.jquery.com/ui/1.11.4/jquery-ui.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/js-cookie/2.0.3/js.cookie.js	"></script>
	<script>
		$(document).ready(function(){
			if(Cookies.get("gridder")!=undefined){
				console.log(Cookies.get("gridder"));
				$("#container").html(decodeURI(Cookies.get("gridder")));
			}
			//este hook √© uma gamb, peguei do stackoverflow HEIAUEHIAUHAE
			//serve pra pegar hex em vez de rgb quando eu pegar com .css(background-color)
			$.cssHooks.backgroundColor = {
				get: function(elem) {
					if (elem.currentStyle)
						var bg = elem.currentStyle["backgroundColor"];
					else if (window.getComputedStyle)
						var bg = document.defaultView.getComputedStyle(elem,
							null).getPropertyValue("background-color");
					if (bg.search("rgb") == -1)
						return bg;
					else {
						bg = bg.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);
						function hex(x) {
							return ("0" + parseInt(x).toString(16)).slice(-2);
						}
						return "#" + hex(bg[1]) + hex(bg[2]) + hex(bg[3]);
					}
				}
			}
			
			//iniciar os sortables maravilhosos
			$( ".sortable" ).sortable();
			$( ".sortable" ).disableSelection();
			  
			//aqui os blocos ganham propriedades e m√°gica come√ßa
			
			
			$("#container").delegate(".bloco", "click", function(e){
				e.stopPropagation();
				$(this).attr("data-nome", "novo nome");	
				console.log($(this).css("background-color"));
				$("#color-picker").val($(this).css("background-color"));
				$("#div-cores").css("background-color", $("#color-picker").val());
				$("#data-ativo").val($(this).attr("data-id"));
				$(".ativo").removeClass("ativo");
				$(this).addClass("ativo");
				//$("#wrapper-menu").show("slide", { direction: "left", easing: "easeOutExpo" }, 700);
			});
			
			//menu da direita
			
						
			//cores man//
			
			$("#div-cores").click(function (){
				console.log("eu existo");
				$("#color-picker").click();
				
			});
			
			$("#color-picker").change(function(){
				$("#div-cores").css("background-color", $(this).val());
				$(".ativo").css("background-color",$(this).val());
			});
			
			
			//efeitos ao sair do menu esquerdo//
			
			
			
			// modelos e coisas// 
			var modelo = '<div class="bloco" data-id="###" data-tamanho="1"></div>',
				contador = 1;
			var w_grid = $('#container').width();
			var h_grid = $('#container').height();
			
			//novo bloco//
			
			$("#novo-bloco").click(function(){
				var pronto = modelo.replace(/###/g, contador);
				contador += 1;
				$("#container").append(pronto);
				console.log(contador);
				$(".bloco[data-id = " + (contador-1) + " ]").trigger("click");
			});
			
			//aumentar um grid-lvl pra direita ou baixo//
			
			$("#aumentar-direita").click(function(){
				var tamanho = $(".ativo").width(),
					margem = parseInt($(".ativo").css("margin-left"));
					extra = 14; //aqui √© o tamanho extra que ser√° adicionado
				tamanho += extra;
				if(margem+tamanho<=w_grid){
					$(".ativo").css("width", tamanho);
				}
			});
			$("#aumentar-esquerda").click(function(){
				var tamanho = $(".ativo").width(),
					extra = 14; //aqui √© o tamanho extra que ser√° removido
				console.log(tamanho);
				if(tamanho>extra){					
					$(".ativo").css("width", (tamanho-extra));
				}
			});
			$("#aumentar-baixo").click(function(){
				var tamanho = $(".ativo").height(),
					margem = parseInt($(".ativo").css("margin-top"))
					extra = 14; //aqui √© o tamanho extra que ser√° adicionado
				tamanho += extra;
				if(margem+tamanho<=h_grid){
					$(".ativo").css("height", tamanho);
				}
			});
			$("#aumentar-cima").click(function(){
				var tamanho = $(".ativo").height(),
					extra = 14; //aqui √© o tamanho extra que ser√° adicionado
				
				
				if(tamanho>extra){
					$(".ativo").css("height", tamanho-extra);
				}
			});
			
			
			//aumentar a margem AKA botar pro lado//
			
			$("#margem-direita").click(function(){
				var margem = parseInt($(".ativo").css("marginLeft")),
					tamanho = $(".ativo").width();
					extra = 14; //aqui √© o tamanho extra que ser√° adicionado
				margem += extra;
				if(margem+tamanho<=w_grid){
					$(".ativo").css("margin-left", margem);
				}
				
				console.log(margem);
			});
			$("#margem-esquerda").click(function(){
				var margem = parseInt($(".ativo").css("marginLeft")),
					tamanho = $(".ativo").width();
					extra = 14; //aqui √© o tamanho extra que ser√° adicionado
				console.log("eu estou aqui!");
				if(margem+tamanho<=w_grid && margem>extra){
					$(".ativo").css("margin-left", margem-extra);
				}
				
				console.log(margem);
			});
			$("#margem-baixo").click(function(){
				var margem = parseInt($(".ativo").css("margin-top")),
					tamanho = $(".ativo").height();
					extra = 14; //aqui √© o tamanho extra que ser√° adicionado
				margem += extra;
				if(margem+tamanho<=h_grid){
					$(".ativo").css("margin-top", margem);
				}
				console.log(margem);
			});
			$("#margem-cima").click(function(){
				var margem = parseInt($(".ativo").css("margin-top")),
					tamanho = $(".ativo").height();
					extra = 14; //aqui √© o tamanho extra que ser√° adicionado
				if(margem+tamanho<=h_grid && margem>extra){
					$(".ativo").css("margin-top", margem-extra);
				}
				console.log(margem);
			});
			
			
			//escape - nova linha//
			
			$("#escape").click(function(){
				$(".ativo").before("<div class='clearboth'></div>");
			});
			$("#descape").click(function(){
				$(".ativo").prev(".clearboth").remove();
			});
			
			$("#excluir").click(function(){
				$(".ativo").hide("slide", { direction: "left" }, 100, function(){
					$(".ativo").remove();
				});			
			});
			
			$("#salvar").click(function(){
				var conteudo = $.trim($("#container").html());
				console.log("gridder="+conteudo);
				Cookies.set('gridder', conteudo);
			});
		});
	
	</script>
</html>
